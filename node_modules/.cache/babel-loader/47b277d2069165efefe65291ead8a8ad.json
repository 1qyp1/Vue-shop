{"ast":null,"code":"import Header from \"@/components/search/Header.vue\";\nimport Tabbar from \"@/components/common/Tabbar.vue\";\nimport http from \"@/common/api/request.js\";\nexport default {\n  data() {\n    return {\n      goodsList: [],\n      searchList: {\n        currentIndex: 0,\n        data: [{\n          name: \"综合\",\n          key: 'zh'\n        }, {\n          name: \"价格\",\n          status: 0,\n          key: \"price\"\n        }, {\n          name: \"销量\",\n          status: 0,\n          key: \"num\"\n        }]\n      }\n    };\n  },\n\n  components: {\n    Header,\n    Tabbar\n  },\n\n  created() {\n    this.getData();\n  },\n\n  computed: {\n    orderBy() {\n      // 知道当前是哪个对象\n      let obj = this.searchList.data[this.searchList.currentIndex]; // 针对状态，判断是升序还是降序\n\n      let val = obj.status == 1 ? \"asc\" : \"desc\";\n      return {\n        // 意思是price或者num是asc或者是desc\n        [obj.key]: val\n      };\n    }\n\n  },\n  methods: {\n    getData() {\n      http.$axios({\n        url: \"/api/goods/shopList\",\n        params: {\n          searchName: this.$route.query.key,\n          ...this.orderBy\n        }\n      }).then(res => {\n        this.goodsList = res;\n      });\n    },\n\n    changeTab(index) {\n      this.searchList.currentIndex = index; // 点击的下标对应数据的哪一个\n\n      let item = this.searchList.data[index]; // 取消所有的状态值=》都变成0\n\n      this.searchList.data.forEach((v, i) => {\n        if (i != index) {\n          v.status = 0;\n        }\n      });\n\n      if (index == this.searchList.currentIndex) {\n        // 当前点击的改变状态\n        item.status = item.status == 1 ? 2 : 1;\n      } // 发送请求进行数据排序\n\n\n      this.getData();\n    }\n\n  },\n  watch: {\n    $route() {\n      this.getData();\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAiDA;AACA;AACA;AAEA;EACAA;IACA;MACAC,aADA;MAEAC;QACAC,eADA;QAEAH,OACA;UAAAI;UAAAC;QAAA,CADA,EAEA;UAAAD;UAAAE;UAAAD;QAAA,CAFA,EAGA;UAAAD;UAAAE;UAAAD;QAAA,CAHA;MAFA;IAFA;EAWA,CAbA;;EAcAE;IACAC,MADA;IAEAC;EAFA,CAdA;;EAkBAC;IACA;EACA,CApBA;;EAqBAC;IACAC;MACA;MACA,6DAFA,CAGA;;MACA;MACA;QACA;QACA;MAFA;IAIA;;EAVA,CArBA;EAiCAC;IACAC;MACAC;QACAC,0BADA;QAEAC;UACAC,iCADA;UAEA;QAFA;MAFA,GAOAC,IAPA,CAOAC;QACA;MACA,CATA;IAUA,CAZA;;IAaAC;MACA,qCADA,CAEA;;MACA,uCAHA,CAIA;;MACA;QACA;UACAC;QACA;MACA,CAJA;;MAKA;QACA;QACAC;MACA,CAbA,CAcA;;;MACA;IACA;;EA7BA,CAjCA;EAgEAC;IACAC;MACA;IACA;;EAHA;AAhEA","names":["data","goodsList","searchList","currentIndex","name","key","status","components","Header","Tabbar","created","computed","orderBy","methods","getData","http","url","params","searchName","then","res","changeTab","v","item","watch","$route"],"sourceRoot":"src/views/search","sources":["Search-list.vue"],"sourcesContent":["<template>\r\n  <div class=\"search-list\">\r\n    <div class=\"header\">\r\n      <Header></Header>\r\n      <ul v-if=\"goodsList.length\"> \r\n        <li\r\n          v-for=\"(item, index) in searchList.data\"\r\n          :key=\"index\"\r\n          @click=\"changeTab(index)\"\r\n        >\r\n          <div :class=\"searchList.currentIndex == index ? 'active' : ''\">\r\n            {{ item.name }}\r\n          </div>\r\n          <div class=\"search-filter\" v-if=\"index != 0\">\r\n            <i\r\n              class=\"iconfont icon-shangjiantou\"\r\n              :class=\"item.status == 1 ? ' active' : ''\"\r\n            ></i>\r\n            <i\r\n              class=\"iconfont icon-xiajiantou\"\r\n              :class=\"item.status == 2 ? ' active' : ''\"\r\n            ></i>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n      <h1 v-else>暂无数据.....</h1>\r\n    </div>\r\n\r\n    <section>\r\n      <ul>\r\n        <li v-for=\"(item, index) in goodsList\" :key=\"index\">\r\n          <img v-lazy=\"item.imgUrl\" alt=\"\" />\r\n          <h3>{{ item.name }}</h3>\r\n\r\n          <div class=\"price\">\r\n            <div>\r\n              <span>￥</span>\r\n              <b>{{ item.price }}</b>\r\n            </div>\r\n            <div>立即购买</div>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </section>\r\n    <Tabbar></Tabbar>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Header from \"@/components/search/Header.vue\";\r\nimport Tabbar from \"@/components/common/Tabbar.vue\";\r\nimport http from \"@/common/api/request.js\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      goodsList: [],\r\n      searchList: {\r\n        currentIndex: 0,\r\n        data: [\r\n          { name: \"综合\" ,key:'zh'},\r\n          { name: \"价格\", status: 0,key:\"price\" },\r\n          { name: \"销量\", status: 0 ,key:\"num\"},\r\n        ],\r\n      },\r\n    };\r\n  },\r\n  components: {\r\n    Header,\r\n    Tabbar,\r\n  },\r\n  created() {\r\n    this.getData();\r\n  },\r\n  computed:{\r\n    orderBy(){\r\n      // 知道当前是哪个对象\r\n      let obj = this.searchList.data[this.searchList.currentIndex]\r\n      // 针对状态，判断是升序还是降序\r\n      let val =  obj.status == 1? \"asc\":\"desc\" \r\n      return{\r\n        // 意思是price或者num是asc或者是desc\r\n        [obj.key]:val\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    getData() {\r\n      http.$axios({\r\n          url: \"/api/goods/shopList\",\r\n          params: {\r\n            searchName: this.$route.query.key,\r\n            ...this.orderBy\r\n          },\r\n        })\r\n        .then((res) => {\r\n          this.goodsList = res;\r\n        });\r\n    },\r\n    changeTab(index) {\r\n      this.searchList.currentIndex = index;\r\n      // 点击的下标对应数据的哪一个\r\n      let item = this.searchList.data[index];\r\n      // 取消所有的状态值=》都变成0\r\n      this.searchList.data.forEach((v, i) => {\r\n        if (i != index) {\r\n          v.status = 0;\r\n        }\r\n      });\r\n      if (index == this.searchList.currentIndex) {\r\n        // 当前点击的改变状态\r\n        item.status = item.status == 1 ? 2 : 1;\r\n      }\r\n      // 发送请求进行数据排序\r\n      this.getData()\r\n    },\r\n  },\r\n  watch: {\r\n    $route() {\r\n      this.getData();\r\n    },\r\n  },\r\n};\r\n</script >\r\n\r\n<style scoped lang=\"scss\">\r\n.search-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n}\r\nsection {\r\n  flex: 1;\r\n  overflow: hidden;\r\n  ul {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: space-around;\r\n  li {\r\n  /* background-color:gray; */\r\n  width: 50%;\r\n  display: flex;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  box-sizing: border-box;\r\n  padding: 0 10px;\r\n  width: 50%;\r\n}\r\n}\r\n}\r\n.header ul {\r\n  display: flex;\r\n  justify-content: space-around;\r\n  padding: 10px 0;\r\n}\r\n.header ul li {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.search-filter {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n\r\nsection ul li img {\r\n  width: 170px;\r\n  height: 170px;\r\n}\r\nsection ul li h3 {\r\n  width: 100%;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  font-size: 15px;\r\n  color: #222;\r\n  font-weight: 400;\r\n}\r\n.price {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  width: 100%;\r\n  color: red;\r\n  font-size: 14px;\r\n  padding: 7px 0;\r\n}\r\n.price div:last-child {\r\n  padding: 2px 2px;\r\n  color: #fff;\r\n  background-color: #b0352f;\r\n  border-radius: 6px;\r\n}\r\n.active {\r\n  color: red;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}